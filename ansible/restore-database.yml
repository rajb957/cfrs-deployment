---
- name: Restore PostgreSQL Database
  hosts: localhost
  tasks:
    - name: Get the name of the postgres pod
      shell: kubectl get pods -l app=postgres -o jsonpath='{.items[0].metadata.name}'
      register: postgres_pod

    - name: Debug container names in the postgres pod
      shell: kubectl get pod {{ postgres_pod.stdout }} -o jsonpath='{.spec.containers[*].name}'
      register: container_names

    - name: Display container names
      debug:
        msg: "Container Names: {{ container_names.stdout }}"

    - name: Copy the backup.sql file to the postgres pod
      command:
        kubectl cp ../backup/backup.sql {{ postgres_pod.stdout }}:/tmp/backup.sql -c container_names